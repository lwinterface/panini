
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.5">
    
    
      
        <title>Authentication - Panini</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.558e4712.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Panini" class="md-header__button md-logo" aria-label="Panini" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Panini
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Authentication
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/lwinterface/panini" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lwinterface/panini
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Panini" class="md-nav__button md-logo" aria-label="Panini" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Panini
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/lwinterface/panini" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lwinterface/panini
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/What_is_NATS/" class="md-nav__link">
        üè∞ What is NATS?
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Install/" class="md-nav__link">
        üöö Install
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Quickstart/" class="md-nav__link">
        üç≥ Quickstart
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" tabindex="0" aria-expanded="false">
          üë©‚Äçüéì Panini interface
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="üë©‚Äçüéì Panini interface" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          üë©‚Äçüéì Panini interface
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Panini_App_Arguments/" class="md-nav__link">
        App Arguments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Panini_App_Functions/" class="md-nav__link">
        App Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Incoming_Message_Structure/" class="md-nav__link">
        Incoming message structure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Panini_Validation/" class="md-nav__link">
        How to validate that microservice connected to NATS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Datatypes/" class="md-nav__link">
        üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Datatypes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Authentication/" class="md-nav__link">
        üîë Authentication
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Data_Validation/" class="md-nav__link">
        üëÆ‚Äç‚ôÇÔ∏è Incoming data validation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Middlewares/" class="md-nav__link">
        üññ Middlewares
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/HTTP_server/" class="md-nav__link">
        ü¶Ü HTTP server
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/WebSocket_server/" class="md-nav__link">
        ü¶Ö WebSocket server example
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Balancer/" class="md-nav__link">
        ü§π Balancer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/JetStream/" class="md-nav__link">
        ‚õì JetStream
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Application_monitoring/" class="md-nav__link">
        üëÄ Application Monitoring
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Emulator/" class="md-nav__link">
        üï∞Ô∏è Emulator - "time machine" debug
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Distributed_tracing/" class="md-nav__link">
        üîç Distributed tracing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Deployment/" class="md-nav__link">
        üèóÔ∏è Deployment
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Changelog/" class="md-nav__link">
        üìã Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/License/" class="md-nav__link">
        üóΩ License
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/How_to_contribute/" class="md-nav__link">
        üëê How to contribute
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Testing/" class="md-nav__link">
        üîß Testing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.7.2/Logger/" class="md-nav__link">
        üìã Logger
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Authentication</h1>

<p>Authentication is essential for any system, especially microservice architectures. Modern design approaches tend to isolate and encapsulate microservices. For the NATS world, this becomes especially critical with the release of one of the key features of NATS 2.0 - decentralized security. This feature allows creating access groups at NATS client level and at subject level. In other words, it "containerizes" a network, which opens up new possibilities for engineers. </p>
<p>NATS offers several authentication strategies, we suggest you explore them here: <a href="https://docs.nats.io/developing-with-nats/security">https://docs.nats.io/developing-with-nats/security</a></p>
<p>Panini does not interact with the authentication process. In fact, it just gives the interface of <a href="http://nats.py/">nats.py</a> to establish a connection with authentication. NATS supports user-password, token, JWT, TLS, and NKeys authentication.</p>
<p>Let's make an example with User-password. First, we need to run NATS broker with user-password access:</p>
<div class="highlight"><pre><span></span><code><span class="n">nats</span><span class="o">-</span><span class="n">server</span> <span class="o">--</span><span class="n">user</span> <span class="n">john</span> <span class="o">--</span><span class="k">pass</span> <span class="n">johnpassword</span>
</code></pre></div>
<p>Then let's write a microservice that connects to NATS but without the user and the password:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">panini</span> <span class="kn">import</span> <span class="n">app</span> <span class="k">as</span> <span class="n">panini_app</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">panini_app</span><span class="o">.</span><span class="n">App</span><span class="p">(</span>
    <span class="n">service_name</span><span class="o">=</span><span class="s2">&quot;some_microservice&quot;</span><span class="p">,</span>
    <span class="n">host</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="mi">4222</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div>
<p>Let's save it to a file named <em><a href="http://app.py">app.py</a></em> and run it:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">app</span><span class="o">.</span><span class="n">py</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">04</span> <span class="mi">14</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="mi">07</span><span class="p">,</span><span class="mi">163</span> <span class="n">nats</span><span class="o">.</span><span class="n">aio</span><span class="o">.</span><span class="n">client</span> <span class="n">ERROR</span>    <span class="n">nats</span><span class="p">:</span> <span class="n">encountered</span> <span class="n">error</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;*/*/*&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">318</span><span class="p">,</span> <span class="ow">in</span> <span class="n">connect</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_connect_init</span><span class="p">()</span>
  <span class="n">File</span> <span class="s2">&quot;*/*/*&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1673</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_process_connect_init</span>
    <span class="k">raise</span> <span class="n">NatsError</span><span class="p">(</span><span class="s2">&quot;nats: &quot;</span> <span class="o">+</span> <span class="n">err_msg</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">))</span>
<span class="n">nats</span><span class="o">.</span><span class="n">aio</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">NatsError</span><span class="p">:</span> <span class="n">nats</span><span class="p">:</span> <span class="s1">&#39;Authorization Violation&#39;</span>
</code></pre></div>
<p>As you can see, an 'Authorization Violation' raised. There is no way to establish a connection with the NATS broker without credentials. Let's add the username and the password to our app:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">panini</span> <span class="kn">import</span> <span class="n">app</span> <span class="k">as</span> <span class="n">panini_app</span>

<span class="n">auth</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;john&quot;</span><span class="p">,</span>
    <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;jpassword&quot;</span>
<span class="p">}</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">panini_app</span><span class="o">.</span><span class="n">App</span><span class="p">(</span>
    <span class="n">service_name</span><span class="o">=</span><span class="s2">&quot;some_microservice&quot;</span><span class="p">,</span>
    <span class="n">host</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="mi">4222</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="n">auth</span>
<span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div>
<p>Let's run it again:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">app</span><span class="o">.</span><span class="n">py</span>
<span class="o">======================================================================================</span>
<span class="n">Panini</span> <span class="n">service</span> <span class="n">connected</span> <span class="n">to</span> <span class="n">NATS</span><span class="o">..</span>
<span class="nb">id</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">name</span><span class="p">:</span> <span class="n">some_microservice__non_docker_env_270377__75017</span>

<span class="n">NATS</span> <span class="n">brokers</span><span class="p">:</span>
<span class="o">*</span>  <span class="n">nats</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">4222</span>
<span class="o">======================================================================================</span>
</code></pre></div>
<p>It seems we have connected to the NATS broker! </p>
<p>You can check out more on authentication in <a href="https://github.com/nats-io/nats.py/blob/main/readme.md">nats.py specs</a> or <a href="https://docs.nats.io/developing-with-nats/security">NATS docs</a>.</p>
<h4 id="_1"><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h4>
<p>Authentication is an essential step for any system, especially in microservice architectures. NATS 2.X offers a decentralized security feature which allows the creation of access groups at both the NATS client and subject level. This feature provides engineers with a secure and flexible environment to work with. </p>
<p>NATS supports various authentication strategies, such as user-password, token, JWT, TLS, and NKeys. In the following example, we will show how to set up a microservice to connect to NATS using a user-password authentication. </p>
<p>First, we need to run NATS broker with user-password access: </p>
<div class="highlight"><pre><span></span><code><span class="n">nats</span><span class="o">-</span><span class="n">server</span> <span class="o">--</span><span class="n">user</span> <span class="n">john</span> <span class="o">--</span><span class="k">pass</span> <span class="n">johnpassword</span>
</code></pre></div>
<p>Then let's create a microservice that connects to the NATS broker without the user and the password. We will save it to a file named <em>app.py</em>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">panini</span> <span class="kn">import</span> <span class="n">app</span> <span class="k">as</span> <span class="n">panini_app</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">panini_app</span><span class="o">.</span><span class="n">App</span><span class="p">(</span>
    <span class="n">service_name</span><span class="o">=</span><span class="s2">&quot;some_microservice&quot;</span><span class="p">,</span>
    <span class="n">host</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="mi">4222</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div>
<p>Let's run it:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">app</span><span class="o">.</span><span class="n">py</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">04</span> <span class="mi">14</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="mi">07</span><span class="p">,</span><span class="mi">163</span> <span class="n">nats</span><span class="o">.</span><span class="n">aio</span><span class="o">.</span><span class="n">client</span> <span class="n">ERROR</span>    <span class="n">nats</span><span class="p">:</span> <span class="n">encountered</span> <span class="n">error</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;*/*/*&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">318</span><span class="p">,</span> <span class="ow">in</span> <span class="n">connect</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_connect_init</span><span class="p">()</span>
  <span class="n">File</span> <span class="s2">&quot;*/*/*&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1673</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_process_connect_init</span>
    <span class="k">raise</span> <span class="n">NatsError</span><span class="p">(</span><span class="s2">&quot;nats: &quot;</span> <span class="o">+</span> <span class="n">err_msg</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">))</span>
<span class="n">nats</span><span class="o">.</span><span class="n">aio</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">NatsError</span><span class="p">:</span> <span class="n">nats</span><span class="p">:</span> <span class="s1">&#39;Authorization Violation&#39;</span>
</code></pre></div>
<p>An 'Authorization Violation' was raised because the NATS broker requires credentials to establish a connection. To resolve this, let's add the username and the password to our app:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">panini</span> <span class="kn">import</span> <span class="n">app</span> <span class="k">as</span> <span class="n">panini_app</span>

<span class="n">auth</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;john&quot;</span><span class="p">,</span>
    <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;jpassword&quot;</span>
<span class="p">}</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">panini_app</span><span class="o">.</span><span class="n">App</span><span class="p">(</span>
    <span class="n">service_name</span><span class="o">=</span><span class="s2">&quot;some_microservice&quot;</span><span class="p">,</span>
    <span class="n">host</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="mi">4222</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="n">auth</span>
<span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div>
<p>We can now run the app again:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">app</span><span class="o">.</span><span class="n">py</span>
<span class="o">======================================================================================</span>
<span class="n">Panini</span> <span class="n">service</span> <span class="n">connected</span> <span class="n">to</span> <span class="n">NATS</span><span class="o">..</span>
<span class="nb">id</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">name</span><span class="p">:</span> <span class="n">some_microservice__non_docker_env_270377__75017</span>

<span class="n">NATS</span> <span class="n">brokers</span><span class="p">:</span>
<span class="o">*</span>  <span class="n">nats</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">4222</span>
<span class="o">======================================================================================</span>
</code></pre></div>
<p>We have successfully connected to the NATS broker! </p>
<p>For more information on authentication in NATS, please refer to the <a href="https://github.com/nats-io/nats.py/blob/main/readme.md">nats.py specs</a> or <a href="https://docs.nats.io/developing-with-nats/security">NATS docs</a>.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.51d95adb.min.js"></script>
      
    
  </body>
</html>